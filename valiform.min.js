/* by manufosela@gmail.com 2015 MIT LICENSE */
var Valiform=function(){"use strict";return window.isIE=window.isIE||function(){var t=navigator.userAgent.toLowerCase();return-1!=t.indexOf("msie")?parseInt(t.split("msie")[1]):!1},isIE()&&!function(t,e){t=document,e=t.createStyleSheet(),t.querySelectorAll=function(r,n,i,a,o){for(o=t.all,n=[],r=r.replace(/\[for\b/gi,"[htmlFor").split(","),i=r.length;i--;){for(e.addRule(r[i],"k:v"),a=o.length;a--;)o[a].currentStyle.k&&n.push(o[a]);e.removeRule(0)}return n}}(),Valiform=function(t){t=t||{warningColor:"#F60",asteriskStyle:"color: #F00!important; font-size: 15px!important; padding-left:3px;",cssTextWarning:"font-size:12px!important; color:#F60!important; font-weight:bold!important; margin-bottom:10px!important;"},this.warningColor=t.warningColor||"#F00",this.asteriskStyle=t.asteriskStyle||"color:#F00!important; padding-left:3px",this.cssTextWarning=t.cssTextWarning||"color:#F00!important",this.numWarnings=0,this.text={requiredField:"campo requerido",wrongValue:"valor incorrecto"},this.badValue=0;for(var e,r,n,i,a,o=this,s=document.querySelectorAll("form[data-validate=true]"),l=0,u=s.length,d=0,c=function(t){t.preventDefault?(t.preventDefault(),t.stopPropagation()):t.returnValue=!1,t=t||window.event;var e=t.target||t.srcElement,r=e.formParam;return n=o.noEmptyFields(),i=o.validateFields(),n&&i&&o._triggerEvent(r,"submit"),o.checkFieldsRealTime(r),!1};u>l;l++)for(this.markRequiredFields(s[l]),"true"===s[l].getAttribute("data-checkrealtime")&&this.checkFieldsRealTime(s[l]),this.hiddenFieldsActions(s[l]),a=s[l].getAttribute("id"),e=document.querySelectorAll("#"+a+" [type=submit][data-checkform=true]"),r=e.length,n=!1,i=!1;r>d;d++){var p=e[d];p.formParam=s[l],this._on(p,"click",c)}if(null===document.getElementById("valiformStyles")){var m=document.createElement("style");m.setAttribute("id","valiformStyles"),m.setAttribute("type","text/css"),isIE()?m.styleSheet.cssText=".isHidden{ display:none; }":m.innerHTML=".isHidden{ display:none; }",document.getElementsByTagName("head")[0].appendChild(m)}},Valiform.prototype.validate=function(t,e){if(""===t||null===t||""!==t&&"noempty"==e)return!0;switch(e){case"int":case"integer":return this.isInt(t);case"float":return this.isFloat(t);case"number":case"numero":return this.isNumber(t);case"alpha":case"alfa":case"text":case"texto":return this.isAlpha(t);case"text-":return this.isAlphaGuion(t);case"alphaNumericSpace":case"textspace":return this.isAlphaNumericSpace(t);case"alphaNumeric":case"textnum":return this.isAlphaNumeric(t);case"email":case"correo":return this.isEmail(t);case"iccid":return this.checkICCID(t);case"nummovil":case"movil":case"mobile":return this.checkNumMovil(t);case"numfijo":case"fijo":case"landphone":return this.checkNumFijo(t);case"telefono":case"tel":case"telephone":return this.checkTelephoneNumber(t);case"cp":case"postalcode":return this.checkCodPostal(t);case"cuentabancaria":case"accountnumber":return this.verificaCuentaBancaria(t);case"tarjetacredito":case"creditcard":return this.verificaNumTarjetaCredito(t);case"nif":case"cif":case"nie":return valida_nif_cif_nie(t);case"fecha":case"date":return isDate(t,"dmy");case"selected":case"noempty":return""!==t}return!1},Valiform.prototype.isInt=function(t){return t==parseInt(t)},Valiform.prototype.isFloat=function(t){return t==parseFloat(t)},Valiform.prototype.isNumber=function(t){var e=/^[0-9\.]+$/;return e.test(t)},Valiform.prototype.isEmail=function(t){return/^\w+([\.-]?\w+)*@\w+([\.-]?\w+)*(\.\w{2,4})+$/.test(t)},Valiform.prototype.verificaCuentaBancaria=function(t){for(var e="00"+t.substr(0,8),r=t.substr(8,2),n=t.substr(10),i=new Array(1,2,4,8,5,10,9,7,3,6),a=0,o=0,s=0;9>=s;s++)a+=parseInt(e.charAt(s))*i[s];for(a=11-a%11,11==a&&(a=0),10==a&&(a=1),s=0;9>=s;s++)o+=parseInt(n.charAt(s))*i[s];return o=11-o%11,11==o&&(o=0),10==o&&(o=1),a.toString()+o.toString()==r},Valiform.prototype.verificaNumTarjetaCredito=function(t){var e=!1,r=3==t[0]||4==t[0]||5==t[0]||6==t[0];return 16==t.length&&r&&(e=this._getCtrlNumberCreditCard(t)==t[15]),e},Valiform.prototype._getCtrlNumberCreditCard=function(t){var e,r,n=0;for(e=1;16>e;e++)e/2!==parseInt(e/2)?(r=2*parseInt(t[e-1]),r>=10&&(r-=9)):r=parseInt(t[e-1]),n+=r;return n=10-n%10,10===n&&(n=0),n},Valiform.prototype.isAlpha=function(t){var e=/^[A-Za-z\s\xF1\xD1áéíóúÁÉÍÓÚäëïöüAËÏÖÜÑñçÇ\']+$/,r=e.test(t);return r},Valiform.prototype.isAlphaGuion=function(t){var e=/^[A-Za-z\s\xF1\xD1áéíóúÁÉÍÓÚäëïöüAËÏÖÜÑñçÇ\'\-]+$/,r=e.test(t);return r},Valiform.prototype.isAlphaNumeric=function(t){var e=/^[0-9A-Za-záéíóúÁÉÍÓÚäëïöüAËÏÖÜÑñçÇ\']+$/,r=e.test(t);return r},Valiform.prototype.isAlphaNumericSpace=function(t){var e=/^[0-9A-Za-z\s\xF1\xD1áéíóúÁÉÍÓÚäëïöüAËÏÖÜÑñçÇ\']+$/,r=e.test(t);return r},Valiform.prototype.isDate=function(t,e){var r=t;if(""===r)return!1;var n=/^(\d{1,2})(\/|-)(\d{1,2})(\/|-)(\d{4})$/,i=r.match(n);if(null===i)return!1;switch(e){case"mdy":dtMonth=i[1],dtDay=i[3],dtYear=i[5];break;case"ymd":dtYear=i[1],dtMonth=i[5],dtDay=i[7];break;default:dtDay=i[1],dtMonth=i[3],dtYear=i[5]}if(dtMonth<1||dtMonth>12)return!1;if(dtDay<1||dtDay>31)return!1;if((4==dtMonth||6==dtMonth||9==dtMonth||11==dtMonth)&&31==dtDay)return!1;if(2==dtMonth){var a=dtYear%4===0&&(dtYear%100!==0||dtYear%400===0);if(dtDay>29||29==dtDay&&!a)return!1}return!0},Valiform.prototype.checkNumMovil=function(t){var e=/^[67]\d{8}$/,r=new RegExp(e);return r.test(t)?1:0},Valiform.prototype.checkNumFijo=function(t){var e=/^[89]\d{8}$/,r=new RegExp(e);return r.test(t)?1:0},Valiform.prototype.checkTelephoneNumber=function(t){return this.checkNumFijo(t)||this.checkNumMovil(t)?1:-2},Valiform.prototype.checkCodPostal=function(t){return 5==t.length&&this.isInt(t)},Valiform.prototype.checkICCID=function(t){var e=parseInt(t.substring(t.length-1,t.length)),r=t.substring(0,t.length-1);return"89"!=t.substring(0,2)?0:this._CalculateLuhn(r)==parseInt(e)&&(19==t.length||20==t.length)?1:0},Valiform.prototype._CalculateLuhn=function(t){var e=0;for(i=0;i<t.length;i++)e+=parseInt(t.substring(i,i+1));var r=new Array(0,1,2,3,4,-4,-3,-2,-1,0);for(i=t.length-1;i>=0;i-=2){var n=parseInt(t.substring(i,i+1)),a=r[n];e+=a}var o=e%10;return o=10-o,10==o&&(o=0),o},Valiform.prototype.calcDigitoControl2LineaNIF=function(t){for(var e=[7,3,1],r=0,n=0,i=t.length;i>r;r++)n+=t[r]*e[r%3];return n%10},Valiform.prototype._getLetraNIF=function(t){var e="TRWAGMYFPDXBNJZSQVHLCKE",r=t%23,n=e.charAt(r);return n},Valiform.prototype.valida_nif_cif_nie=function(t){var e,r,n,i,a,o,s,l,u,d=t.toUpperCase(),c="TRWAGMYFPDXBNJZSQVHLCKE";if("PASAPORTE"==document.getElementById("documento_de_identidad").getAttribute("value"))return 1;if(""!==d){if(!/^[A-Z]{1}[0-9]{7}[A-Z0-9]{1}$/.test(d)&&!/^[T]{1}[A-Z0-9]{8}$/.test(d)&&!/^[0-9]{8}[A-Z]{1}$/.test(d))return 0;if(/^[0-9]{8}[A-Z]{1}$/.test(d))return o=t.substring(8,0)%23,s=c.charAt(o),l=d.charAt(8),s==l?1:-1;for(u=parseInt(t.charAt(2))+parseInt(t.charAt(4))+parseInt(t.charAt(6)),n=1;8>n;n+=2)e=2*parseInt(t.charAt(n)),e+="",e=e.substring(0,1),r=2*parseInt(t.charAt(n)),r+="",r=r.substring(1,2),""===r&&(r="0"),u+=parseInt(e)+parseInt(r);if(u+="",i=10-parseInt(u.substring(u.length-1,u.length)),/^[KLM]{1}/.test(d))return t.charAt(8)==String.fromCharCode(64+i)?1:-1;if(/^[ABCDEFGHJNPQRSUVW]{1}/.test(d))return d=i+"",t.charAt(8)==String.fromCharCode(64+i)||t.charAt(8)==parseInt(d.substring(d.length-1,d.length))?2:-2;if(/^[T]{1}[A-Z0-9]{8}$/.test(d))return t.charAt(8)==/^[T]{1}[A-Z0-9]{8}$/.test(d)?3:-3;if(/^[XYZ]{1}/.test(d))return d=d.replace("X","0"),d=d.replace("Y","1"),d=d.replace("Z","2"),a=d.substring(0,8)%23,t.toUpperCase().charAt(8)==c.substring(a,a+1)?3:-3}return 0},Valiform.prototype.markRequiredFields=function(t,e){if("undefined"==typeof t)return!1;e="undefined"!=typeof e?e:"*";for(var r,n,i,a,o=this,s=t.getAttribute("id"),l=document.querySelectorAll("#"+s+" [data-required=true]"),u=0,d=l.length;d>u;u++)a=l[u].getAttribute("type")||l[u].type,"hidden"!=a&&"true"!=l[u].getAttribute("data-hidden")&&(i=l[u].getAttribute("name"),null===document.getElementById("asterisco_"+i)&&(r=document.createElement("span"),r.setAttribute("id","asterisco_"+i),r.setAttribute("style",this.asteriskStyle),r.innerHTML=e,null!==document.getElementById("label_"+i)?document.getElementById("label_"+i).appendChild(r):(n=o._getAllSiblings(l[u],"LABEL"),n.length>0&&n[0].appendChild(r))))},Valiform.prototype.validateFields=function(){this.badValue=0;for(var t,e,r=this,n=document.querySelectorAll("[data-tovalidate]"),i=0,a=n.length;a>i;i++)t=n[i].getAttribute("value")||n[i].value||"",e=n[i].getAttribute("data-tovalidate")||"",r.validate(t,e)||(r.addWarnMesg(n[i],r.text.wrongValue),this.badValue++);return 0===this.badValue},Valiform.prototype.noEmptyFields=function(){for(var t,e,r,n=this,i=0,a=document.querySelectorAll("[data-required=true]"),o=0,s=a.length;s>o;o++)r=a[o].getAttribute("type")||a[o].type,"hidden"!=r&&"true"!=a[o].getAttribute("data-hidden")&&(t=a[o].getAttribute("value")||a[o].value||"",e=a[o].getAttribute("type")||a[o].type||"","radio"==e?i+=n.checkRadioField(a[o]):"checkbox"==e?a[o].checked?n.delWarnMesg(a[o]):(n.addWarnMesg(a[o],n.text.requiredField),i++):""===t?(n.addWarnMesg(a[o],n.text.requiredField),i++):n.delWarnMesg(a[o]));return 0===i},Valiform.prototype.checkRadioField=function(t){for(var e=0,r=0,n=t.getAttribute("name"),i=this._getParentElement(t,"form"),a=i.getAttribute("id"),o=document.querySelector("[data-name="+n+"]")||t,s=document.querySelectorAll("#"+a+" [name="+n+"]"),l=0,u=s.length;u>l;l++)if(s[l].checked){r++;break}return 0===r?(this.addWarnMesg(o,this.text.requiredField),e++):this.delWarnMesg(o),e},Valiform.prototype.addWarnMesg=function(t,e){var r,n="undefined"!=typeof t.getAttribute?t:window.event.srcElement,i=n.getAttribute("name")||n.getAttribute("id")||"",a="warning-"+i;document.getElementById(a)?r=document.getElementById(a):(t=document.getElementById(n.getAttribute("id")||t.id),r=document.createElement("p"),r.setAttribute("id",a)),r.setAttribute("class","warning"),r.setAttribute("style",this.cssTextWarning),r.innerHTML=e;var o="radio"===t.type?t.nextSibling.nextSibling:t.nextSibling;t.parentElement.insertBefore(r,o),t.setAttribute("style","border:2px solid "+this.warningColor+"!important;");var s=t.getBoundingClientRect().top-document.body.getBoundingClientRect().top-70;this.numWarnings++,1==this.numWarnings&&$("html, body").animate({scrollTop:s},"slow")},Valiform.prototype.delWarnMesg=function(t){var e="undefined"!=typeof t.getAttribute?t:window.event.srcElement,r=e.getAttribute("name")||e.getAttribute("id")||"";document.getElementById("warning-"+r)&&e.parentElement.removeChild(document.getElementById("warning-"+r)),this.removeStyle(t),this.numWarnings>0&&this.numWarnings--},Valiform.prototype.hasClass=function(t,e){var r=new RegExp("(\\s|^)"+e+"(\\s|$)"),n="undefined"==typeof t.className?window.event.srcElement:t;return n.className.match(r)},Valiform.prototype.addClass=function(t,e){if(!this.hasClass(t,e)){var r="undefined"!=typeof t.getAttribute?t:window.event.srcElement,n=""!==r.className?" ":"";r.className+=n+e}},Valiform.prototype.removeClass=function(t,e){if(this.hasClass(t,e)){var r=new RegExp("(\\s|^)"+e+"(\\s|$)"),n="undefined"!=typeof t.getAttribute?t:window.event.srcElement;n.className=n.className.replace(r,"")}},Valiform.prototype.removeStyle=function(t){var e="undefined"!=typeof t.getAttribute?t:window.event.srcElement;e.removeAttribute("style")},Valiform.prototype.checkFieldsRealTime=function(t){for(var e,r,n,i,a=this,o=this._getArrayFromTag(t,"input"),s=this._getArrayFromTag(t,"textarea"),l=this._getArrayFromTag(t,"select"),u="undefined"!=typeof s?o.concat(s):o,d=0,c=u.length,p=function(t){a.fnBlur(t)},m=function(t){a.fnSel(t)};c>d;d++)e=document.getElementById(u[d].getAttribute("id")),r=e.getAttribute("data-required"),n=e.getAttribute("data-tovalidate"),i=e.getAttribute("type")||e.type||"",("true"==r||""!==n)&&(a._off(e,"blur",p),a._on(e,"blur",p),("checkbox"==i||"radio"==i)&&a._on(e,"click",p));for(d=0,c=l.length;c>d;d++)e=document.getElementById(l[d].getAttribute("id")),r=e.getAttribute("data-required"),"true"==r&&(a._on(e,"click",m),a._on(e,"change",m),a._on(e,"blur",m))},Valiform.prototype.hiddenFieldsActions=function(){for(var t,e,r,n,i,a,o,s,l=this,u=document.querySelectorAll("[data-activate]"),d=0,c=u.length,p=function(t){l.fnShowHidden(t)};c>d;d++)if(this.addClass(u[d],"isHidden"),n=u[d].getAttribute("data-activate"),t=document.getElementById(n))for(e=t.getAttribute("name"),o=this._getParentElement(u[d],"form"),s=o.getAttribute("id"),r=document.querySelectorAll("#"+s+" [name="+e+"]"),i=0,a=r.length;a>i;i++)this._on(r[i],"blur",p),this._on(r[i],"click",p)},Valiform.prototype.fnBlur=function(t){t=t||window.event;var e=t.target||t.srcElement,r=e.value||e.getAttribute("value")||"",n=e["data-tovalidate"]||e.getAttribute("data-tovalidate")||"",i=e["data-required"]||e.getAttribute("data-required")||"",a="true"==i,o=""!==n,s=e.type||e.getAttribute("type")||"";if(a)if("radio"==s)this.checkRadioField(e);else if("checkbox"==s){if(!e.checked)return this.addWarnMesg(e,this.text.requiredField),!0;this.delWarnMesg(e)}else{if(""===r)return this.addWarnMesg(e,this.text.requiredField),!0;this.delWarnMesg(e)}o&&(this.validate(r,n)?this.delWarnMesg(e):(this.badValue++,this.addWarnMesg(e,this.text.wrongValue)))},Valiform.prototype.fnSel=function(t){t=t||window.event;var e=t.target||t.srcElement,r=e.value||e.getAttribute("value")||"";return""===r?(this.addWarnMesg(e,this.text.requiredField),!0):void this.delWarnMesg(e)},Valiform.prototype.fnShowHidden=function(t){t=t||window.event;var e,r,n,i,a,o,s,l,u=t.target||t.srcElement,d=u.id||u.getAttribute("id")||"",c=document.querySelectorAll("[data-activate*="+d+"]"),p=document.querySelectorAll("[data-deactivate*="+d+"]"),m=0,f=c.length,h=p.length;if(f>0)for(;f>m;m++)for(this.removeClass(c[m],"isHidden"),e=c[m].getAttribute("id"),n=document.querySelectorAll("#"+e+" input[data-hidden=true]"),i=0,a=n.length;a>i;i++)n[i].setAttribute("data-hidden","false");if(m=0,h>0)for(;h>m;m++)for(this.addClass(p[m],"isHidden"),r=p[m].getAttribute("id"),n=document.querySelectorAll("#"+r+" input[data-hidden=false]"),i=0,a=n.length;a>i;i++)n[i].setAttribute("data-hidden","true"),o=n[i].getAttribute("type")||n[i].type,s=n[i].parentElement,l=s.tagName.toUpperCase()||"","LABEL"==l&&("radio"==o&&this.removeClass(s,"r_on"),"checkbox"==o&&this.removeClass(s,"c_on"))},Valiform.prototype._on=function(t,e,r){window.addEventListener?t.addEventListener(e,r,!1):window.attachEvent?t.attachEvent("on"+e,r):t["on"+e]=r},Valiform.prototype._off=function(t,e,r){window.removeEventListener?t.removeEventListener(e,r,!1):window.detachEvent?t.detachEvent("on"+e,r):elem["on"+e]=null},Valiform.prototype._triggerEvent=function(t,e){var r;document.createEvent?(r=document.createEvent("MouseEvents"),r.initEvent(e,!0,!0)):(r=document.createEventObject(),r.eventType=e),r.eventName=e,document.createEvent?t.dispatchEvent(r):t.fireEvent("on"+r.eventType,r)},Valiform.prototype._toType=function(t){if("undefined"==typeof t)return"undefined";if(null===t)return"null";var e=Object.prototype.toString.call(t).match(/^\[object\s(.*)\]$/)[1]||"";switch(e){case"Number":return isNaN(t)?"nan":"number";case"String":case"Boolean":case"Array":case"Date":case"RegExp":case"Function":return e.toLowerCase()}return"object"==typeof t?"object":void 0},Valiform.prototype._getArrayFromTag=function(t,e){return Array.prototype.slice.call(t.getElementsByTagName(e))},Valiform.prototype._getAllSiblings=function(t,e){var r=[];if("undefined"!=typeof t){var n=function(t){return"undefined"!=typeof t.tagName?t.tagName.toUpperCase()==e.toUpperCase():!1},i=t.parentNode;t=i.firstChild;do(!n||n(t))&&r.push(t);while(t=t.nextSibling);0===r.length&&r.push(i)}return r},Valiform.prototype._getParentElement=function(t,e){e=e.toUpperCase();var r=t;do r=r.parentElement;while(null!==r&&r.tagName.toUpperCase()!==e);return r},Valiform.prototype._elementChildren=function(t){for(var e=t.childNodes,r=[],n=e.length;n--;)1==e[n].nodeType&&r.unshift(e[n]);return r},Valiform}();!function(){"use strict";var t=Array.prototype.slice;try{t.call(document.documentElement)}catch(e){Array.prototype.slice=function(e,r){if(r="undefined"!=typeof r?r:this.length,"[object Array]"===Object.prototype.toString.call(this))return t.call(this,e,r);var n,i,a=[],o=this.length,s=e||0;s=s>=0?s:Math.max(0,o+s);var l="number"==typeof r?Math.min(r,o):o;if(0>r&&(l=o+r),i=l-s,i>0)if(a=new Array(i),this.charAt)for(n=0;i>n;n++)a[n]=this.charAt(s+n);else for(n=0;i>n;n++)a[n]=this[s+n];return a}}}();